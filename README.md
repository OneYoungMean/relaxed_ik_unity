# relaxed_ik_unity
This is the Unity wrapper of Relaxed IK.

## Run
1. Click play in Unity.
2. Hold left Alt key and use your mouse to navigate the camera.
3. Use the GUI at the left side to play with the robot arm.
4. Set a robot arm as active to play with it. Make sure only one robot arm is active at the same time.

## Steps of setting up a robot arm
1. If you would like to use your own config files for a robot that we provided config files in relaxed_ik_core/config or work on a new robot that we didn't provide config files, please go to [relaxed_ik](https://github.com/uwgraphics/relaxed_ik) to generate required config files. After you have those files, put the corresponding config files (generated by relaxed_ik) into each subfolder in relaxed_ik_core/config. Replace the given files if you are updating config files for a provided robot. You can skip this step if you would like to work on a robot whose config files are provided by us.
2. Follow the steps at [ros-sharp wiki](https://github.com/siemens/ros-sharp/wiki/User_App_NoROS_ImportURDFOnWindows) to set up the simulation of the robot arm in Unity. Please make sure that the urdf file has inertia information in it, otherwise the joints may not be set up correctly.
3. Once the robot arm is loaded, add the RelaxedIKUnity script in Assets/Scripts to it. Set up the list of robot Limbs and end effectors by adding the corresponding game object to the list. The size of this list should be the same as the size of joint angle solution array published by RelaxedIK for the corresponding robot. You can refer to the corresponding xxx_info.yaml for which, how many and the order of links to add to the list. Be careful that you only want those links with the Hinge Joint component which imply that they are associated with revolute joints. You also need to drag and drop the transform(s) of the end effector(s) and the gripper prefab (which can be found at Assets/Prefabs/Gripper) to the Relaxed IK Unity component.
4. On the component of the UrdfRobot script, enable Is Kinematic and All Convex Colliders and disable Use Gravity and Use Inertia from URDF.
5. Optional: Add a child named `ViewCenter` tot the robot arm to configure the position of the camera at runtime.

## Known Issues
1. In order to transform the orginal coordinate system in rviz to fit inside Unity, I write some hard code in RelaxedIKUnity.cs.
2. When the end effector is dragged to some point that the robot arm cannot reach (e.g. not long enough), EEPoseGoals go out of the range.
3. For the sawyer robot arm, dragging the gripper in the x (or y) axis will lead to changes in the y (or x) coordinate of the pose goal.
4. For yumi and panda, relaxed IK doesn't run very smoothly, might be the problem of their config files
